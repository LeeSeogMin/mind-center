# Chapter 8. Supabase ì‹œì‘í•˜ê¸° â€” AíšŒì°¨: ê°•ì˜

> **ë¯¸ì…˜**: ê³µê°í„°(`mind-center`) ì›¹ì‚¬ì´íŠ¸ì— Supabase ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—°ê²°í•œë‹¤

---

## ì´ ì¥ì˜ ì „ì²´ íë¦„

ì•„ë˜ ë‹¤ì´ì–´ê·¸ë¨ì´ ì´ë²ˆ ì¥ì—ì„œ í•  ì¼ì˜ **ì „ë¶€**ì´ë‹¤. 8ë‹¨ê³„ë¥¼ ìˆœì„œëŒ€ë¡œ ì§„í–‰í•˜ë©´ Supabase ì—°ê²°ì´ ì™„ë£Œëœë‹¤.

```mermaid
flowchart TD
    A["â‘  í”„ë¡œì íŠ¸ ìƒì„±<br/><small>supabase.com â†’ New Project</small>"]
    B["â‘¡ API í‚¤ í™•ì¸<br/><small>Project Settings â†’ Data API â†’ anon key ë³µì‚¬</small>"]
    C["â‘¢ íŒ¨í‚¤ì§€ ì„¤ì¹˜<br/><small>npm install @supabase/supabase-js @supabase/ssr</small>"]
    D["â‘£ .env.local ì„¤ì •<br/><small>URL + ANON_KEY ì…ë ¥</small>"]
    E["â‘¤ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ì‘ì„±<br/><small>lib/supabase/client.ts + server.ts</small>"]
    F["â‘¥ SQL ìŠ¤í‚¤ë§ˆ ì‹¤í–‰<br/><small>SQL Editor â†’ supabase-schema.sql ë¶™ì—¬ë„£ê¸° â†’ Run</small>"]
    G["â‘¦ ì—°ê²° í…ŒìŠ¤íŠ¸<br/><small>localhost:3000/test â†’ 'Supabase ì—°ê²° ì„±ê³µ!'</small>"]
    H["â‘§ Vercel í™˜ê²½ ë³€ìˆ˜ ë“±ë¡<br/><small>Project Settings â†’ Environment Variables</small>"]

    A -->|"ğŸ–±ï¸ ìˆ˜ë™"| B
    B -->|"ğŸ–±ï¸ ìˆ˜ë™"| C
    C -->|"âŒ¨ï¸ í„°ë¯¸ë„"| D
    D -->|"âœï¸ ìˆ˜ë™"| E
    E -->|"ğŸ¤– Copilot"| F
    F -->|"ğŸ–±ï¸ SQL Editor"| G
    G -->|"ğŸ¤– Copilot"| H

    style A fill:#FBF8F3,stroke:#8B6B4E,color:#3A2E26
    style B fill:#FBF8F3,stroke:#8B6B4E,color:#3A2E26
    style C fill:#f0f9ff,stroke:#3b82f6,color:#1e3a5f
    style D fill:#f0f9ff,stroke:#3b82f6,color:#1e3a5f
    style E fill:#f0f9ff,stroke:#3b82f6,color:#1e3a5f
    style F fill:#FBF8F3,stroke:#8B6B4E,color:#3A2E26
    style G fill:#f0fdf4,stroke:#22c55e,color:#14532d
    style H fill:#FBF8F3,stroke:#8B6B4E,color:#3A2E26
```

| ë‹¨ê³„ | ì‘ì—…                            |    ì‹¤í–‰    | ë„êµ¬     |  ì„¹ì…˜   |
| :--: | ------------------------------- | :--------: | -------- | :-----: |
|  â‘    | Supabase í”„ë¡œì íŠ¸ ìƒì„±          |  ğŸ–±ï¸ ì§ì ‘   | ë¸Œë¼ìš°ì € |  8.2.1  |
|  â‘¡   | API URL + anon key ë³µì‚¬         |  ğŸ–±ï¸ ì§ì ‘   | ëŒ€ì‹œë³´ë“œ |  8.2.3  |
|  â‘¢   | `@supabase/ssr` íŒ¨í‚¤ì§€ ì„¤ì¹˜     | ğŸ¤– Copilot | í„°ë¯¸ë„   |  8.3.1  |
|  â‘£   | `.env.local`ì— í‚¤ ì…ë ¥          |  ğŸ–±ï¸ ì§ì ‘   | VS Code  |  8.3.2  |
|  â‘¤   | `lib/supabase/client.ts` ì‘ì„±   | ğŸ¤– Copilot | VS Code  |  8.3.3  |
|  â‘¥   | SQL ìƒì„± + SQL Editor ì‹¤í–‰      |   ğŸ¤–+ğŸ–±ï¸    | ëŒ€ì‹œë³´ë“œ | 8.4.1~2 |
|  â‘¦   | `localhost:3000/test` ì—°ê²° í™•ì¸ | ğŸ¤– Copilot | ë¸Œë¼ìš°ì € |  8.3.5  |
|  â‘§   | Vercelì— í™˜ê²½ ë³€ìˆ˜ ë“±ë¡         |  ğŸ–±ï¸ ì§ì ‘   | Vercel   |  8.3.4  |

**ê³ ì • ë²„ì „** (ì´ êµì¬ ê¸°ì¤€):

| íŒ¨í‚¤ì§€                  | ë²„ì „   |
| ----------------------- | ------ |
| `next`                  | 16.1.6 |
| `@supabase/supabase-js` | 2.97.0 |
| `@supabase/ssr`         | 0.8.0  |
| `tailwindcss`           | 4.x    |

---

## ë°”ì´ë¸Œì½”ë”© ì›ì¹™ (ì´ë²ˆ ì¥)

ì´ë²ˆ ì¥ì˜ ë°”ì´ë¸Œì½”ë”© í•µì‹¬ì€ â€œ**DB/í™˜ê²½ë³€ìˆ˜/ì—°ê²° ë°©ì‹**ì„ Copilotì´ ì¶”ì¸¡í•˜ì§€ ì•Šê²Œ ë§Œë“œëŠ” ê²ƒâ€ì´ë‹¤. DBëŠ” í•œ ë²ˆ ì˜ëª» ë§Œë“¤ë©´ ì´í›„ ì¥(ì¸ì¦, CRUD, RLS, UX) ì „ì²´ê°€ ê¼¬ì¸ë‹¤.

1. **ìŠ¤í‚¤ë§ˆë¥¼ ë¨¼ì € ê³ ì •**: í…Œì´ë¸” ì´ë¦„/ì»¬ëŸ¼/íƒ€ì…/ê´€ê³„ë¥¼ ì„¤ê³„ì„œ(Ch7) ê¸°ì¤€ìœ¼ë¡œ í™•ì •í•˜ê³ , Copilotì—ê²Œ ê·¸ëŒ€ë¡œ ì¤€ë‹¤.
2. **í™˜ê²½ë³€ìˆ˜ ì´ë¦„ì„ ì •í™•íˆ**: ë¡œì»¬(`.env.local`)ê³¼ ë°°í¬(Vercel) ê°’, `NEXT_PUBLIC_*` ê³µê°œ ë²”ìœ„ë¥¼ ëª…ì‹œí•œë‹¤.
3. **Supabase ìì›ì„ ëª…ì‹œ**: `auth.users` ê¸°ë°˜ + í”„ë¡œì íŠ¸ì˜ `public.users`(Auth í™•ì¥) ê°™ì€ â€œí™•ì¥ í…Œì´ë¸”â€ ì‚¬ìš© ì—¬ë¶€ë¥¼ ë¨¼ì € ê²°ì •í•œë‹¤.
4. **ì‹¤í–‰ ìˆœì„œë¥¼ í¬í•¨**: (1) í”„ë¡œì íŠ¸ ìƒì„± â†’ (2) í‚¤ ë°œê¸‰/í™˜ê²½ë³€ìˆ˜ â†’ (3) í´ë¼ì´ì–¸íŠ¸ ì—°ê²° â†’ (4) SQL ì‹¤í–‰ â†’ (5) Next.jsì—ì„œ ì½ê¸° í…ŒìŠ¤íŠ¸.
5. **ê²€ì¦ì„ â€œì¿¼ë¦¬â€ë¡œ í•œë‹¤**: â€œì˜ ëì–´ìš”â€ê°€ ì•„ë‹ˆë¼, `select`ë¡œ ë°ì´í„°ê°€ ë³´ì´ê³ , ì½˜ì†”/ë„¤íŠ¸ì›Œí¬ê°€ ì •ìƒì¸ì§€ë¡œ í™•ì¸í•œë‹¤.

---

## ì œì‘ ê³¼ì • (ì²˜ìŒë¶€í„° ì‹œì‘)

Ch7ì—ì„œ ë¬¸ì„œ(ARCHITECTURE.md, copilot-instructions.md)ë¡œ â€œë¬´ì—‡ì„ ë§Œë“¤ì§€â€ë¥¼ ì •í–ˆë‹¤ë©´, ì´ë²ˆ ì¥ì—ì„œëŠ” **ë°ì´í„°ë² ì´ìŠ¤ë¥¼ â€˜ì‚¬ì‹¤(Truth)â€™ë¡œ ê³ ì •**í•œë‹¤.  
ì—¬ê¸°ì„œ ìŠ¤í‚¤ë§ˆ/í‚¤/ì—°ê²°ì´ í”ë“¤ë¦¬ë©´, ì´í›„(ì¸ì¦/CRUD/RLS/UX) ë‹¨ê³„ëŠ” ì „ë¶€ í”ë“¤ë¦°ë‹¤.

### 8.0.1 Copilotì´ ê°•í•œ êµ¬ê°„ vs êµ³ì´ ì•ˆ ì¨ë„ ë˜ëŠ” êµ¬ê°„

- Copilotì´ ê°•í•œ êµ¬ê°„: ìŠ¤í‚¤ë§ˆ ì´ˆì•ˆ ê²€í† , SQL ìŠ¤í¬ë¦½íŠ¸ ì •ë¦¬, ì²´í¬ë¦¬ìŠ¤íŠ¸/ê²€ì¦ ì¿¼ë¦¬ ì‘ì„±, Next.js ì—°ê²° ì½”ë“œ ë¼ˆëŒ€
- êµ³ì´ ì•ˆ ì¨ë„ ë˜ëŠ” êµ¬ê°„: Supabase ëŒ€ì‹œë³´ë“œ í´ë¦­ ì‘ì—…, í‚¤ ë°œê¸‰/ë³µì‚¬/ë¶™ì—¬ë„£ê¸°, ë¹„ë°€í‚¤/ê¶Œí•œ ê´€ë¦¬, ì‹¤ì œ SQL ì‹¤í–‰ ë²„íŠ¼ í´ë¦­

### 8.0.2 ê¶Œì¥ ì œì‘ ìˆœì„œ (DB ê³ ì • ë£¨íŠ¸)

1. **Supabase í”„ë¡œì íŠ¸ ìƒì„±**: í”„ë¡œì íŠ¸/ë¦¬ì „/DB íŒ¨ìŠ¤ì›Œë“œë¥¼ ì •í•œë‹¤.
2. **í™˜ê²½ë³€ìˆ˜ ê³ ì •**: `.env.local`ì— URL/ANON KEYë¥¼ ë„£ê³  â€œì•±ì´ í‚¤ë¥¼ ì½ëŠ”ë‹¤â€ê¹Œì§€ í™•ì¸í•œë‹¤.
3. **ìŠ¤í‚¤ë§ˆ í™•ì •**: `supabase-schema.sql`ì„ ê¸°ì¤€ìœ¼ë¡œ í…Œì´ë¸”/FK/ì œì•½ì„ ë§Œë“ ë‹¤.
4. **RLSëŠ” ì´ˆì•ˆì´ë¼ë„ ì¼ ë‹¤**: ìµœì†Œ ì •ì±…(SELECT/INSERT)ë¶€í„° ê±¸ì–´ â€œë³´ì•ˆ ê¸°ë³¸ê°’â€ì„ ë§Œë“ ë‹¤.
5. **ì—°ê²° ê²€ì¦**: Next.jsì—ì„œ SELECT 1ê°œ, INSERT 1ê°œë¥¼ ì„±ê³µì‹œí‚¤ê³  ê²°ê³¼ë¥¼ í™•ì¸í•œë‹¤.

### 8.0.3 ì œì‘ ê³¼ì •ìš© Copilot í”„ë¡¬í”„íŠ¸ ì„¸íŠ¸ (ë‹¨ê³„ë³„)

#### (1) Supabase í”„ë¡œì íŠ¸ ìƒì„± ì²´í¬ë¦¬ìŠ¤íŠ¸

```text
ë„ˆëŠ” GitHub Copilot Chatì´ì•¼. ì§€ê¸ˆë¶€í„° `mind-center` í”„ë¡œì íŠ¸ì˜ Supabaseë¥¼ "ì²˜ìŒë¶€í„°" ì„¸íŒ…í•œë‹¤.
ë‚´ê°€ ëŒ€ì‹œë³´ë“œì—ì„œ ë¬´ì—‡ì„ í•´ì•¼ í•˜ëŠ”ì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ì•ˆë‚´í•´ì¤˜.

[ìš”êµ¬ ì¶œë ¥]
1) Supabase í”„ë¡œì íŠ¸ ìƒì„± ì‹œ ê²°ì •í•´ì•¼ í•  ê²ƒ(í”„ë¡œì íŠ¸ëª…/ë¦¬ì „/DB ë¹„ë°€ë²ˆí˜¸)
2) ìƒì„± í›„ ë°”ë¡œ í™•ì¸í•  ê²ƒ: Project URL, anon key, service role key(ì‚¬ìš© ê¸ˆì§€ ì•ˆë‚´ í¬í•¨)
3) ë¡œì»¬ ê°œë°œì—ì„œ í•„ìš”í•œ ê²ƒ vs ë°°í¬(Vercel)ì—ì„œ í•„ìš”í•œ ê²ƒ êµ¬ë¶„
4) í”í•œ ì‹¤ìˆ˜ TOP 5 (ì˜ˆ: env ì´ë¦„ ì˜¤íƒ€, NEXT_PUBLIC ë²”ìœ„, í‚¤ë¥¼ ì»¤ë°‹í•¨ ë“±)
```

#### (2) `.env.local` ì„¤ê³„ + ë³´ì•ˆ ê·œì¹™

```text
ë„ˆëŠ” GitHub Copilot Chatì´ì•¼. Next.js(App Router)ì—ì„œ Supabaseë¥¼ ì—°ê²°í•˜ë ¤ê³  í•œë‹¤.
`.env.local`ì— ë„£ì„ í™˜ê²½ë³€ìˆ˜ ì´ë¦„ì„ ì •í™•íˆ ì •ë¦¬í•´ì¤˜(ê°’ì€ ë¹„ì›Œë‘¬).

[ìš”êµ¬ ì¶œë ¥]
- í•„ìš”í•œ env ëª©ë¡(ë¡œì»¬ìš©): ì´ë¦„ + ì„¤ëª… + ì˜ˆì‹œ í˜•íƒœ(ê°’ì€ ***ë¡œ ë§ˆìŠ¤í‚¹)
- `NEXT_PUBLIC_`ë¥¼ ë¶™ì—¬ì•¼ í•˜ëŠ” ê²ƒ/ë¶™ì´ë©´ ì•ˆ ë˜ëŠ” ê²ƒ
- `.gitignore`ì— `.env.local`ì´ ë“¤ì–´ê°€ì•¼ í•˜ëŠ” ì´ìœ (1~2ì¤„)
```

#### (3) Supabase í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ë¼ˆëŒ€(ë¸Œë¼ìš°ì €/ì„œë²„)

```text
ë„ˆëŠ” GitHub Copilot Chatì´ì•¼. Next.js App Routerì—ì„œ Supabase í´ë¼ì´ì–¸íŠ¸ë¥¼ í‘œì¤€ ë°©ì‹ìœ¼ë¡œ êµ¬ì„±í•˜ê³  ì‹¶ë‹¤.

[ìš”êµ¬ ì¶œë ¥]
1) ì¶”ì²œ íŒŒì¼ ê²½ë¡œì™€ ì½”ë“œ:
   - `lib/supabase/client.ts` (browser client)
   - `lib/supabase/server.ts` (server client, cookies ì—°ë™)
2) ê° íŒŒì¼ì´ ì–¸ì œ ì“°ì´ëŠ”ì§€(í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ vs ì„œë²„ ì»´í¬ë„ŒíŠ¸ vs route handler)

ì œì•½: `@supabase/ssr` íŒ¨í„´ì„ ì‚¬ìš©í•˜ê³ , env ì´ë¦„ì€ ìœ„ì—ì„œ ì •í•œ ê²ƒì„ ì‚¬ìš©í•œë‹¤.
```

#### (4) ìŠ¤í‚¤ë§ˆ í™•ì •: `supabase-schema.sql` ì‹¤í–‰/ê²€í† 

```text
ë„ˆëŠ” GitHub Copilot Chatì´ì•¼. ë‚´ê°€ Supabase SQL Editorì—ì„œ ì‹¤í–‰í•  ìŠ¤í‚¤ë§ˆ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í™•ì •í•˜ë ¤ê³  í•œë‹¤.

[ì»¨í…ìŠ¤íŠ¸]
- í”„ë¡œì íŠ¸ ë¬¸ì„œ: `ARCHITECTURE.md`ì˜ Data Model(ì´ˆì•ˆ)
- ëª©í‘œ ê¸°ëŠ¥: ì˜ˆì•½, ë§ˆìŒí†¡, ê²Œì‹œíŒ, ë§ˆì´í˜ì´ì§€

[ìš”êµ¬ ì¶œë ¥]
1) í…Œì´ë¸” ëª©ë¡(ìµœì†Œ): users í™•ì¥, counselors, availability_slots, reservations, mindtalk_posts, mindtalk_comments, board_posts, news_posts
2) ê° í…Œì´ë¸”ì˜ ìµœì†Œ ì»¬ëŸ¼(íƒ€ì… ìˆ˜ì¤€ê¹Œì§€)ê³¼ FK ê´€ê³„ ìš”ì•½
3) SQL Editorì—ì„œ ì‹¤í–‰í•  ë•Œì˜ ìˆœì„œ/ì£¼ì˜ì (extensions, FK ìˆœì„œ, íŠ¸ë¦¬ê±° ë“±)

ì£¼ì˜: ë‚´ê°€ ì‹¤ì œë¡œ ë¶™ì—¬ë„£ì„ ìˆ˜ ìˆê²Œ `supabase-schema.sql` íŒŒì¼ ì „ì²´ë¥¼ ì¶œë ¥í•´ì¤˜.
```

#### (5) ì—°ê²° ê²€ì¦: â€œSELECT 1ê°œ + INSERT 1ê°œâ€ í…ŒìŠ¤íŠ¸

```text
ë„ˆëŠ” GitHub Copilot Chatì´ì•¼. Supabase ì—°ê²°ì´ ì œëŒ€ë¡œ ëëŠ”ì§€ ë¹ ë¥´ê²Œ ê²€ì¦í•˜ê³  ì‹¶ë‹¤.

[ìš”êµ¬ ì¶œë ¥]
1) SQL Editorì—ì„œ ì‹¤í–‰í•  ê²€ì¦ ì¿¼ë¦¬ 3ê°œ(SELECT/INSERT í¬í•¨) + ê¸°ëŒ€ ê²°ê³¼
2) Next.jsì—ì„œ ì‹¤í–‰í•  ê²€ì¦ ì½”ë“œ 2ê°œ:
   - ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ `select` í•œ ë²ˆ
   - í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ `insert` í•œ ë²ˆ(ë¡œê·¸ì¸ ì „ì´ë©´ ì„ì‹œë¡œ ê³µê°œ í…Œì´ë¸”ë¡œ)
3) ì‹¤íŒ¨í–ˆì„ ë•Œ í™•ì¸í•  ì²´í¬ë¦¬ìŠ¤íŠ¸(ë„¤íŠ¸ì›Œí¬, env, RLS, ê¶Œí•œ)
```

## Copilot í”„ë¡¬í”„íŠ¸ (ë³µì‚¬/ë¶™ì—¬ë„£ê¸°)

```text
ë„ˆëŠ” GitHub Copilot Chatì´ê³ , ë‚´ Next.js(App Router) + Supabase í”„ë¡œì íŠ¸ì˜ í˜ì–´ í”„ë¡œê·¸ë˜ë¨¸ì•¼.
ëª©í‘œ: `mind-center`ì— Supabaseë¥¼ ì—°ê²°í•˜ê³ , `ARCHITECTURE.md`/`supabase-schema.sql` ê¸°ì¤€ìœ¼ë¡œ í…Œì´ë¸”ì„ ë§Œë“¤ê³ , Next.jsì—ì„œ ì½ê¸° í…ŒìŠ¤íŠ¸ê¹Œì§€ ëë‚¸ë‹¤.

[ê¸°ìˆ /ê·œì¹™]
- Next.js App Router ì‚¬ìš©
- SupabaseëŠ” PostgreSQL ê¸°ë°˜
- `auth.users`ë¥¼ ì§ì ‘ ì“°ë˜, í”„ë¡œì íŠ¸ì²˜ëŸ¼ `public.users(id UUID REFERENCES auth.users)` í˜•íƒœì˜ í™•ì¥ í…Œì´ë¸”ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
- ì„ì˜ì˜ í…Œì´ë¸”/ì»¬ëŸ¼ ì´ë¦„ì„ ìƒˆë¡œ ë§Œë“¤ì§€ ë§ê³ , ë¨¼ì € `supabase-schema.sql`ì„ ê¸°ì¤€ìœ¼ë¡œ ë§ì¶°ë¼

[ë‚´ ì„¤ê³„ì„œ ìš”ì•½]
- Page Map í•µì‹¬ ê¸°ëŠ¥: ì˜ˆì•½(`/reservation/*`), ë§ˆìŒí†¡(`/mindtalk`), ê²Œì‹œíŒ(`/board/*`), ë§ˆì´í˜ì´ì§€(`/mypage/*`)
- ë°ì´í„° ì—”í‹°í‹° ì˜ˆ: `users`, `counselors`, `availability_slots`, `reservations`, `mindtalk_posts`, `mindtalk_comments`, `board_posts`, `news_posts`

[ìš”êµ¬ ì¶œë ¥]
1) `.env.local`ì— ë„£ì„ í™˜ê²½ë³€ìˆ˜ ì´ë¦„/ì„¤ëª…(ê°’ì€ ë‚´ê°€ ì±„ì›€)
2) Next.jsì—ì„œ Supabase í´ë¼ì´ì–¸íŠ¸ë¥¼ ì“°ëŠ” ì¶”ì²œ íŒŒì¼ êµ¬ì¡°(ìƒì„±í•  íŒŒì¼ ê²½ë¡œ í¬í•¨)
3) Supabase SQL Editorì— ë¶™ì—¬ë„£ì„ SQL: `supabase-schema.sql` ì‹¤í–‰ ìˆœì„œ/ì£¼ì˜ì  + (í•„ìš” ì‹œ) ìµœì†Œ ìˆ˜ì •ì•ˆ
4) ì—°ê²° ê²€ì¦ìš© í…ŒìŠ¤íŠ¸ ì¿¼ë¦¬ 3ê°œ(SELECT/INSERT í¬í•¨): ì˜ˆ) ìƒë‹´ì‚¬ ëª©ë¡ ì¡°íšŒ, ë§ˆìŒí†¡ ê¸€ 1ê°œ insert, ì˜ˆì•½ ì¡°íšŒ + ê¸°ëŒ€ ê²°ê³¼

ì£¼ì˜: ë‚´ê°€ ì œê³µí•œ ìŠ¤í‚¤ë§ˆ/ê´€ê³„ ì™¸ì—ëŠ” ì„ì˜ë¡œ ì¶”ê°€/ë³€ê²½í•˜ì§€ ë§ê³ , ì• ë§¤í•˜ë©´ ì§ˆë¬¸í•´ì¤˜.
```

## í•™ìŠµëª©í‘œ

1. BaaS(Backend as a Service)ì˜ ê°œë…ê³¼ ì¥ì ì„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤
2. Supabase í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ê³  ëŒ€ì‹œë³´ë“œë¥¼ íƒìƒ‰í•  ìˆ˜ ìˆë‹¤
3. Next.js í”„ë¡œì íŠ¸ì— Supabase í´ë¼ì´ì–¸íŠ¸ë¥¼ ì„¤ì¹˜í•˜ê³  í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤
4. 7ì¥ ì„¤ê³„ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ SQL í…Œì´ë¸”ì„ ìƒì„±í•  ìˆ˜ ìˆë‹¤
5. í…Œì´ë¸” ê´€ê³„(1:N)ë¥¼ ì´í•´í•˜ê³  ì™¸ë˜ í‚¤ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤

---

## ìˆ˜ì—… íƒ€ì„ë¼ì¸

**í‘œ 8.1** AíšŒì°¨ ìˆ˜ì—… íƒ€ì„ë¼ì¸

| ì‹œê°„        | ë‚´ìš©                                                   |
| ----------- | ------------------------------------------------------ |
| 00:00~00:05 | ì˜¤ëŠ˜ì˜ ë¯¸ì…˜ + ë¹ ë¥¸ ì§„ë‹¨                                |
| 00:05~00:25 | BaaS ê°œë… + Supabase í”„ë¡œì íŠ¸ ìƒì„± + ëŒ€ì‹œë³´ë“œ íƒìƒ‰     |
| 00:25~00:50 | Next.js ì—°ê²° + í™˜ê²½ ë³€ìˆ˜ + Vercel ë°°í¬ ì„¤ì •            |
| 00:50~01:20 | ë¼ì´ë¸Œ ì½”ë”©: ë°ì´í„° ëª¨ë¸ë§ + í…Œì´ë¸” ìƒì„± + ì—°ê²° í…ŒìŠ¤íŠ¸ |
| 01:20~01:27 | í•µì‹¬ ì •ë¦¬ + BíšŒì°¨ ê³¼ì œ ìŠ¤í™ ê³µê°œ                       |
| 01:27~01:30 | Exit ticket                                            |

---

## ì˜¤ëŠ˜ì˜ ë¯¸ì…˜ + ë¹ ë¥¸ ì§„ë‹¨

> **ì˜¤ëŠ˜ì˜ ì§ˆë¬¸**: "ì§€ê¸ˆê¹Œì§€ ë§Œë“  ê²Œì‹œíŒì€ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ë°ì´í„°ê°€ ì‚¬ë¼ì§„ë‹¤. ì–´ë–»ê²Œ í•˜ë©´ ë°ì´í„°ë¥¼ ì˜êµ¬ì ìœ¼ë¡œ ì €ì¥í•  ìˆ˜ ìˆì„ê¹Œ?"

**ë¹ ë¥¸ ì§„ë‹¨** (1ë¬¸í•­):

ë‹¤ìŒ ì¤‘ BaaS(Backend as a Service)ì˜ ì„¤ëª…ìœ¼ë¡œ ì˜¬ë°”ë¥¸ ê²ƒì€?

- (A) ë°±ì—”ë“œ ì„œë²„ ì½”ë“œë¥¼ ì§ì ‘ ì‘ì„±í•˜ì—¬ ë°°í¬í•˜ëŠ” ë°©ì‹
- (B) ë°±ì—”ë“œ ê¸°ëŠ¥(DB, ì¸ì¦, API)ì„ ì„œë¹„ìŠ¤ë¡œ ì œê³µë°›ì•„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹
- (C) í”„ë¡ íŠ¸ì—”ë“œ ì—†ì´ ì„œë²„ë§Œìœ¼ë¡œ ì•±ì„ ë§Œë“œëŠ” ë°©ì‹

ì •ë‹µ: (B) â€” BaaSëŠ” ë°ì´í„°ë² ì´ìŠ¤, ì¸ì¦, API ë“±ì„ ì´ë¯¸ ë§Œë“¤ì–´ì§„ ì„œë¹„ìŠ¤ë¡œ ì‚¬ìš©í•œë‹¤.

---

## 8.1 ì™œ Supabaseì¸ê°€?

Ch5~6ì—ì„œ ë§Œë“  ê²Œì‹œíŒì€ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ë°ì´í„°ê°€ ì‚¬ë¼ì§„ë‹¤. ë°ì´í„°ë¥¼ ì˜êµ¬ ì €ì¥í•˜ë ¤ë©´ **ë°ì´í„°ë² ì´ìŠ¤**ê°€ í•„ìš”í•˜ê³ , ì´ ìˆ˜ì—…ì—ì„œëŠ” **Supabase**ë¥¼ ì‚¬ìš©í•œë‹¤.

**Supabase ì„ íƒ ì´ìœ **: PostgreSQL ê¸°ë°˜(SQL í•™ìŠµ ê°€ëŠ¥), ì˜¤í”ˆì†ŒìŠ¤(ì¢…ì† ì—†ìŒ), ë¬´ë£Œ(2ê°œ í”„ë¡œì íŠ¸), Next.js ê³µì‹ ì—°ë™(Vercel íŒŒíŠ¸ë„ˆ).

> **ì›ë¦¬ â€” BaaS(Backend as a Service)**
>
> ì „í†µ ë°©ì‹ì€ ë°±ì—”ë“œ ì„œë²„(Express, Django ë“±)ë¥¼ ì§ì ‘ ë§Œë“¤ì–´ì•¼ í•˜ì§€ë§Œ, BaaSëŠ” DBÂ·ì¸ì¦Â·APIë¥¼ **ì´ë¯¸ ë§Œë“¤ì–´ì§„ ì„œë¹„ìŠ¤**ë¡œ ì œê³µí•œë‹¤. ì£¼ë°©ì„ ì§ì ‘ ì§“ëŠ” ëŒ€ì‹  **ê³µìœ  ì£¼ë°©ì„ ë¹Œë¦¬ëŠ” ê²ƒ**ê³¼ ê°™ë‹¤.
>
> **í‘œ 8.2** BaaSê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥
>
> | ê¸°ëŠ¥         | ì§ì ‘ ë§Œë“¤ë©´                  | BaaS(Supabase) ì‚¬ìš© ì‹œ    |
> | ------------ | ---------------------------- | ------------------------- |
> | ë°ì´í„°ë² ì´ìŠ¤ | PostgreSQL ì„¤ì¹˜, ìŠ¤í‚¤ë§ˆ ì„¤ê³„ | ëŒ€ì‹œë³´ë“œì—ì„œ í…Œì´ë¸” ìƒì„±  |
> | ì¸ì¦         | íšŒì›ê°€ì…, OAuth ì§ì ‘ êµ¬í˜„    | `signInWithOAuth()` í•œ ì¤„ |
> | API          | REST ì—”ë“œí¬ì¸íŠ¸ ì„¤ê³„         | í…Œì´ë¸” ìƒì„± ì‹œ ìë™ ìƒì„±  |
> | ë³´ì•ˆ         | ë¯¸ë“¤ì›¨ì–´, ê¶Œí•œ ì²´í¬ êµ¬í˜„     | RLS ì •ì±…ìœ¼ë¡œ DB ë ˆë²¨ ê°•ì œ |

---

## 8.2 Supabase í”„ë¡œì íŠ¸ ìƒì„± `ğŸ–±ï¸ ì§ì ‘ ì‹¤í–‰`

ì§€ê¸ˆë¶€í„° Supabase í”„ë¡œì íŠ¸ë¥¼ ì§ì ‘ ë§Œë“ ë‹¤. ì´ ì„¤ì •ì€ Ch9~11ê¹Œì§€ ê³„ì† ì‚¬ìš©í•˜ë¯€ë¡œ ì •í™•íˆ ë”°ë¼í•œë‹¤.

> **ì™œ ìˆ˜ë™ì¸ê°€?** â€” Supabase ëŒ€ì‹œë³´ë“œ íšŒì›ê°€ì…/í”„ë¡œì íŠ¸ ìƒì„±/í‚¤ ë³µì‚¬ëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ì§ì ‘ í•´ì•¼ í•œë‹¤. Copilotì´ ëŒ€ì‹ í•  ìˆ˜ ì—†ëŠ” ì˜ì—­ì´ë‹¤.

### 8.2.1 ê°€ì… ë° ìƒˆ í”„ë¡œì íŠ¸ ë§Œë“¤ê¸°

> **í•¨ê»˜ ì§„í–‰**: í™”ë©´ì„ ë³´ë©° í•¨ê»˜ ë”°ë¼í•œë‹¤

â‘  **Supabase ê°€ì…**: https://supabase.com ì—ì„œ **GitHub ê³„ì •ìœ¼ë¡œ ê°€ì…**í•œë‹¤ (ë³„ë„ ì´ë©”ì¼ ê°€ì… ë¶ˆí•„ìš”)

â‘¡ **ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±**: ëŒ€ì‹œë³´ë“œì—ì„œ "New Project" í´ë¦­

â‘¢ **í”„ë¡œì íŠ¸ ì„¤ì •**:

**í‘œ 8.3** í”„ë¡œì íŠ¸ ìƒì„± ì‹œ ì…ë ¥ í•­ëª©

| í•­ëª©              | ì…ë ¥ ê°’                | ì„¤ëª…                                   |
| ----------------- | ---------------------- | -------------------------------------- |
| Organization      | (ê¸°ë³¸ê°’)               | ê°œì¸ ì¡°ì§                              |
| Project name      | `my-board`             | ì˜ë¬¸ ì†Œë¬¸ì, í•˜ì´í”ˆ ì‚¬ìš©               |
| Database Password | (ê°•í•œ ë¹„ë°€ë²ˆí˜¸)        | **ë°˜ë“œì‹œ ë©”ëª¨í•´ë‘”ë‹¤** â€” ì´í›„ ë³€ê²½ ë¶ˆê°€ |
| Region            | Northeast Asia (Tokyo) | í•œêµ­ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ë¦¬ì „              |
| Pricing Plan      | Free                   | ë¬´ë£Œ í”Œëœ ì„ íƒ                         |

â‘£ **ìƒì„± ëŒ€ê¸°**: í”„ë¡œì íŠ¸ ìƒì„±ì— ì•½ 1~2ë¶„ì´ ê±¸ë¦°ë‹¤. ì´ ì‚¬ì´ ëŒ€ì‹œë³´ë“œ êµ¬ì¡°ë¥¼ ì‚´í´ë³¸ë‹¤.

> **íŒ**: Database PasswordëŠ” ë‚˜ì¤‘ì— ë³€ê²½í•  ìˆ˜ ì—†ë‹¤. ë¹„ë°€ë²ˆí˜¸ë¥¼ ê¹Œë¨¹ìœ¼ë©´ í”„ë¡œì íŠ¸ë¥¼ ì‚­ì œí•˜ê³  ë‹¤ì‹œ ë§Œë“¤ì–´ì•¼ í•œë‹¤. ë°˜ë“œì‹œ ì–´ë”˜ê°€ì— ì ì–´ë‘ì.

### 8.2.2 ëŒ€ì‹œë³´ë“œ íƒìƒ‰: Table Editor, SQL Editor, Auth

Supabase ëŒ€ì‹œë³´ë“œëŠ” ë°±ì—”ë“œì˜ ëª¨ë“  ê¸°ëŠ¥ì„ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ëŠ” **ì œì–´íŒ**ì´ë‹¤. í•µì‹¬ ë©”ë‰´ 4ê°€ì§€ë¥¼ ìµíŒë‹¤:

**í‘œ 8.4** Supabase ëŒ€ì‹œë³´ë“œ í•µì‹¬ ë©”ë‰´

| ë©”ë‰´                 | ì—­í•                           | ì´ ìˆ˜ì—…ì—ì„œ ì‚¬ìš© ì‹œì   |
| -------------------- | ----------------------------- | ---------------------- |
| **Table Editor**     | í…Œì´ë¸” ìƒì„±/ìˆ˜ì •, ë°ì´í„° í™•ì¸ | Ch8 (ì˜¤ëŠ˜), Ch10       |
| **SQL Editor**       | SQL ë¬¸ ì§ì ‘ ì‹¤í–‰              | Ch8 (ì˜¤ëŠ˜), Ch10, Ch11 |
| **Authentication**   | ì¸ì¦ ì„¤ì •, ì‚¬ìš©ì ëª©ë¡        | Ch9                    |
| **Project Settings** | API í‚¤, URL í™•ì¸              | Ch8 (ì˜¤ëŠ˜)             |

ë‹¤ë¥¸ ë©”ë‰´(Storage, Edge Functions, Realtime ë“±)ëŠ” ì´ ìˆ˜ì—…ì—ì„œ ë‹¤ë£¨ì§€ ì•Šì§€ë§Œ, í”„ë¡œì íŠ¸ê°€ ì„±ì¥í•˜ë©´ í•„ìš”í•´ì§ˆ ìˆ˜ ìˆë‹¤.

### 8.2.3 API í‚¤ í™•ì¸

Supabaseì™€ Next.jsë¥¼ ì—°ê²°í•˜ë ¤ë©´ ë‘ ê°€ì§€ ì •ë³´ê°€ í•„ìš”í•˜ë‹¤:

â‘  **API URL**: `https://[í”„ë¡œì íŠ¸ID].supabase.co` í˜•íƒœ
â‘¡ **anon (public) key**: í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê³µê°œ í‚¤ (JWT í˜•ì‹)

2026ë…„ í˜„ì¬ Supabase ëŒ€ì‹œë³´ë“œëŠ” API í‚¤ ì²´ê³„ê°€ ê°œí¸ë˜ì—ˆë‹¤. **API URL**ê³¼ **API Key**ì˜ í™•ì¸ ìœ„ì¹˜ê°€ ë‹¤ë¥´ë¯€ë¡œ ì£¼ì˜í•œë‹¤.

**â‘  API URL í™•ì¸**: ì™¼ìª½ ì‚¬ì´ë“œë°” **Integrations** â†’ **Data API** â†’ **API URL**

```text
API URL:  https://abcdefghijk.supabase.co    [Copy]
```

Data API í˜ì´ì§€ì—ì„œ **Enable Data API** í† ê¸€ì´ ì¼œì ¸ ìˆëŠ”ì§€ë„ í™•ì¸í•œë‹¤. ì´ í† ê¸€ì´ êº¼ì ¸ ìˆìœ¼ë©´ Supabase í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤.

**â‘¡ API Key í™•ì¸**: ì™¼ìª½ ì‚¬ì´ë“œë°” **Project Settings** â†’ **API Keys**

API Keys í˜ì´ì§€ì—ëŠ” **ë‘ ê°œì˜ íƒ­**ì´ ìˆë‹¤:

| íƒ­                                     | ë‚´ìš©                                                        |
| -------------------------------------- | ----------------------------------------------------------- |
| **Publishable and secret API keys**    | ìƒˆë¡œìš´ í‚¤ ì²´ê³„ (`sb_publishable_...`, `sb_secret_...` í˜•ì‹) |
| **Legacy anon, service_role API keys** | ê¸°ì¡´ JWT ê¸°ë°˜ í‚¤ (`eyJhbG...` í˜•ì‹)                         |

í˜„ì¬ `@supabase/supabase-js` ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” **Legacy íƒ­**ì˜ JWT í˜•ì‹ í‚¤ë¥¼ ì‚¬ìš©í•œë‹¤. **"Legacy anon, service_role API keys"** íƒ­ì„ í´ë¦­í•˜ì—¬ `anon` `public` í‚¤ë¥¼ ë³µì‚¬í•œë‹¤:

```text
anon  public    eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...    [Copy]
```

> anon keyê°€ ê³µê°œ ê°€ëŠ¥í•˜ë‹¤ëŠ” ê²ƒì´ ì˜ì™¸ì¼ ìˆ˜ ìˆë‹¤. SupabaseëŠ” **RLS(Row Level Security)**ë¡œ ë°ì´í„°ë¥¼ ë³´í˜¸í•œë‹¤. anon keyë¡œ ì ‘ê·¼í•´ë„ RLS ì •ì±…ì´ í—ˆìš©í•œ ë°ì´í„°ë§Œ ë³¼ ìˆ˜ ìˆë‹¤. RLSëŠ” Ch11ì—ì„œ ìì„¸íˆ ë‹¤ë£¬ë‹¤.

> **íŒ**: anon keyëŠ” "ì§‘ ì£¼ì†Œ"ì™€ ê°™ë‹¤. ì£¼ì†ŒëŠ” ì•Œë ¤ì¤˜ë„ ë˜ì§€ë§Œ, ì‹¤ì œ ë°ì´í„°ë¥¼ ë³´í˜¸í•˜ëŠ” ê²ƒì€ RLS(ì ê¸ˆ ì¥ì¹˜)ì˜ ì—­í• ì´ë‹¤.

---

## 8.3 Next.jsì™€ Supabase ì—°ê²°

Supabase í”„ë¡œì íŠ¸ê°€ ì¤€ë¹„ë˜ì—ˆìœ¼ë©´ ê¸°ì¡´ Next.js í”„ë¡œì íŠ¸ì— ì—°ê²°í•œë‹¤.

### 8.3.1 íŒ¨í‚¤ì§€ ì„¤ì¹˜ `âŒ¨ï¸ í„°ë¯¸ë„`

> **ğŸ¤– Copilot í”„ë¡¬í”„íŠ¸**
> "Next.js App Router í”„ë¡œì íŠ¸ì— Supabase í´ë¼ì´ì–¸íŠ¸ë¥¼ ì„¤ì¹˜í•˜ê³  ì´ˆê¸° ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ì•Œë ¤ì¤˜.
> @supabase/supabase-jsì™€ @supabase/ssr ë‘ íŒ¨í‚¤ì§€ê°€ í•„ìš”í•´."

Copilotì´ ì•Œë ¤ì£¼ëŠ” ëª…ë ¹ì–´ë¥¼ í„°ë¯¸ë„ì— ë¶™ì—¬ë„£ëŠ”ë‹¤:

```bash
npm install @supabase/supabase-js @supabase/ssr
```

ì„¤ì¹˜ í›„ **ë²„ì „ í™•ì¸** â€” ì„¤ì¹˜ëœ Supabase íŒ¨í‚¤ì§€ ë²„ì „ì„ í™•ì¸í•˜ê³  copilot-instructions.mdì— ê¸°ë¡í•œë‹¤:

```bash
node -e "const p = require('./package.json'); console.log('@supabase/supabase-js:', p.dependencies['@supabase/supabase-js']); console.log('@supabase/ssr:', p.dependencies['@supabase/ssr'])"
```

copilot-instructions.mdì˜ Tech Stack ì„¹ì…˜ì— ì¶”ê°€í•œë‹¤:

```markdown
## Tech Stack

- @supabase/supabase-js [í™•ì¸í•œ ë²„ì „]
- @supabase/ssr [í™•ì¸í•œ ë²„ì „]
```

> ìƒˆë¡œìš´ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•  ë•Œë§ˆë‹¤ ë²„ì „ì„ í™•ì¸í•˜ê³  copilot-instructions.mdì— ê¸°ë¡í•˜ëŠ” ìŠµê´€ì„ ë“¤ì´ì. ì´ê²ƒì´ Ch2ì—ì„œ ë°°ìš´ **ë²„ì „ ë™ê¸°í™” í”„ë¡œí† ì½œ**ì´ë‹¤.

**í‘œ 8.5** Supabase íŒ¨í‚¤ì§€ ì—­í• 

| íŒ¨í‚¤ì§€                  | ì—­í•                                          |
| ----------------------- | -------------------------------------------- |
| `@supabase/supabase-js` | Supabase í•µì‹¬ í´ë¼ì´ì–¸íŠ¸ (DB, Auth, Storage) |
| `@supabase/ssr`         | Next.js App Routerì—ì„œ ì¿ í‚¤ ê¸°ë°˜ ì„¸ì…˜ ê´€ë¦¬   |

`@supabase/ssr`ì€ **ì„œë²„ ì»´í¬ë„ŒíŠ¸**(Server Component)ì™€ **í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸**(Client Component) ì–‘ìª½ì—ì„œ Supabaseë¥¼ ì•ˆì „í•˜ê²Œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ íŒ¨í‚¤ì§€ì´ë‹¤. Next.js App Router í™˜ê²½ì—ì„œëŠ” ë°˜ë“œì‹œ í•¨ê»˜ ì„¤ì¹˜í•œë‹¤.

### 8.3.2 í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (.env.local) `ğŸ–±ï¸ ì§ì ‘ ì‹¤í–‰`

API í‚¤ë¥¼ í”„ë¡œì íŠ¸ì— ì €ì¥í•œë‹¤. í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `.env.local` íŒŒì¼ì„ ìƒì„±í•œë‹¤:

```bash
# .env.local
NEXT_PUBLIC_SUPABASE_URL=https://[í”„ë¡œì íŠ¸ID].supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**ì£¼ì˜í•  ì  3ê°€ì§€**:

1. **`NEXT_PUBLIC_` ì ‘ë‘ì‚¬**: Next.jsì—ì„œ ë¸Œë¼ìš°ì €ì— ë…¸ì¶œí•  í™˜ê²½ ë³€ìˆ˜ì—ëŠ” ë°˜ë“œì‹œ `NEXT_PUBLIC_` ì ‘ë‘ì‚¬ë¥¼ ë¶™ì¸ë‹¤. ì´ ì ‘ë‘ì‚¬ê°€ ì—†ìœ¼ë©´ ì„œë²„ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.

2. **`.gitignore` í™•ì¸**: `.env.local`ì€ ê¸°ë³¸ì ìœ¼ë¡œ `.gitignore`ì— í¬í•¨ë˜ì–´ ìˆë‹¤. **ì ˆëŒ€ Gitì— ì»¤ë°‹í•˜ì§€ ì•ŠëŠ”ë‹¤**.

3. **ì‹¤ì œ ê°’ ì…ë ¥**: `[í”„ë¡œì íŠ¸ID]`ì™€ `eyJhbG...` ë¶€ë¶„ì„ ë³¸ì¸ì˜ Supabase ëŒ€ì‹œë³´ë“œì—ì„œ í™•ì¸í•œ ê°’ìœ¼ë¡œ êµì²´í•œë‹¤.

> **í”í•œ ì‹¤ìˆ˜**: `.env.local` ëŒ€ì‹  `.env`ì— í‚¤ë¥¼ ë„£ëŠ” ê²½ìš°. `.env`ëŠ” Gitì— ì»¤ë°‹ë  ìˆ˜ ìˆë‹¤. ë°˜ë“œì‹œ `.env.local`ì„ ì‚¬ìš©í•œë‹¤.

### 8.3.3 Supabase í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™” `ğŸ¤– ë°”ì´ë¸Œì½”ë”©`

> **ğŸ¤– Copilot í”„ë¡¬í”„íŠ¸**
> "Next.js App Routerì—ì„œ Supabase í´ë¼ì´ì–¸íŠ¸ë¥¼ ì´ˆê¸°í™”í•˜ëŠ” ìœ í‹¸ë¦¬í‹° íŒŒì¼ì„ ë§Œë“¤ì–´ì¤˜.
> @supabase/ssr íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•´ì„œ, ë¸Œë¼ìš°ì €ìš©(lib/supabase/client.ts)ê³¼ ì„œë²„ìš©(lib/supabase/server.ts) ë‘ íŒŒì¼ì„ ë§Œë“¤ì–´ì¤˜."

Supabase ê³µì‹ ë¬¸ì„œì—ì„œëŠ” **ë¸Œë¼ìš°ì €ìš©**ê³¼ **ì„œë²„ìš©** ë‘ ê°œì˜ í´ë¼ì´ì–¸íŠ¸ë¥¼ ë¶„ë¦¬í•œë‹¤. ë¨¼ì € í´ë” êµ¬ì¡°ë¥¼ ë§Œë“ ë‹¤:

```
lib/
â””â”€â”€ supabase/
    â”œâ”€â”€ client.ts    â† ë¸Œë¼ìš°ì €ìš© (Client Componentì—ì„œ ì‚¬ìš©)
    â””â”€â”€ server.ts    â† ì„œë²„ìš© (Server Component, Route Handlerì—ì„œ ì‚¬ìš©)
```

**ë¸Œë¼ìš°ì €ìš© í´ë¼ì´ì–¸íŠ¸**:

```typescript
// lib/supabase/client.ts
import { createBrowserClient } from "@supabase/ssr";

export function createClient() {
  return createBrowserClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
  );
}
```

> `!`(non-null assertion)ëŠ” TypeScriptì—ê²Œ "ì´ ê°’ì€ ë°˜ë“œì‹œ ì¡´ì¬í•œë‹¤"ê³  ì•Œë ¤ì£¼ëŠ” ê²ƒì´ë‹¤. í™˜ê²½ ë³€ìˆ˜ê°€ `.env.local`ì— ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì–´ ìˆë‹¤ë©´ ì•ˆì „í•˜ë‹¤.

**ì½”ë“œ ì½ê¸° ê°€ì´ë“œ** â€” 3ì¤„ì´ì§€ë§Œ ì¤‘ìš”í•œ í¬ì¸íŠ¸ê°€ ìˆë‹¤:

**í‘œ 8.6** Supabase ë¸Œë¼ìš°ì € í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ í•´ì„

| ì¤„  | ì½”ë“œ                             | ì˜ë¯¸                                                                |
| --- | -------------------------------- | ------------------------------------------------------------------- |
| 1   | `import { createBrowserClient }` | `@supabase/ssr`ì—ì„œ **ë¸Œë¼ìš°ì €ìš©** í´ë¼ì´ì–¸íŠ¸ ìƒì„± í•¨ìˆ˜ë¥¼ ê°€ì ¸ì˜¨ë‹¤  |
| 3   | `export function createClient()` | **íŒ©í† ë¦¬ í•¨ìˆ˜** â€” í˜¸ì¶œí•  ë•Œë§ˆë‹¤ í´ë¼ì´ì–¸íŠ¸ë¥¼ ìƒì„±í•œë‹¤               |
| 4-5 | `process.env.NEXT_PUBLIC_...!`   | `.env.local`ì— ì„¤ì •í•œ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì½ëŠ”ë‹¤ (`!`ëŠ” non-null assertion) |

> ì™œ `createClient`ë¼ëŠ” ì´ë¦„ì¸ê°€? Supabase ê³µì‹ ë¬¸ì„œê°€ ì´ ì´ë¦„ì„ ì‚¬ìš©í•œë‹¤. í”„ë¡œì íŠ¸ ì „ì²´ì—ì„œ `import { createClient } from "@/lib/supabase/client"`ë¡œ í†µì¼í•˜ë©´ ì½”ë“œê°€ ì¼ê´€ëœë‹¤.

**ì„œë²„ìš© í´ë¼ì´ì–¸íŠ¸** â€” ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œë„ Supabaseë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤(ì˜ˆ: ì´ˆê¸° ë°ì´í„° ë¡œë”©, ì¸ì¦ í™•ì¸). ì´ë•ŒëŠ” **ì¿ í‚¤ë¥¼ ì²˜ë¦¬í•˜ëŠ”** ì„œë²„ìš© í´ë¼ì´ì–¸íŠ¸ê°€ í•„ìš”í•˜ë‹¤:

```typescript
// lib/supabase/server.ts
import { createServerClient } from "@supabase/ssr";
import { cookies } from "next/headers";

export async function createClient() {
  const cookieStore = await cookies();
  return createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return cookieStore.getAll();
        },
        setAll(cookiesToSet) {
          try {
            cookiesToSet.forEach(({ name, value, options }) =>
              cookieStore.set(name, value, options),
            );
          } catch {
            // Server Componentì—ì„œ í˜¸ì¶œ ì‹œ ì¿ í‚¤ ì“°ê¸° ë¶ˆê°€ â€” middlewareê°€ ì²˜ë¦¬
          }
        },
      },
    },
  );
}
```

**í‘œ 8.7** ë¸Œë¼ìš°ì € vs ì„œë²„ í´ë¼ì´ì–¸íŠ¸ ë¹„êµ

|               | ë¸Œë¼ìš°ì € (`client.ts`)  | ì„œë²„ (`server.ts`)              |
| ------------- | ----------------------- | ------------------------------- |
| **import**    | `createBrowserClient`   | `createServerClient`            |
| **ì‚¬ìš© ìœ„ì¹˜** | `"use client"` ì»´í¬ë„ŒíŠ¸ | Server Component, Route Handler |
| **ì¿ í‚¤**      | ìë™ ì²˜ë¦¬               | `cookies()` ìˆ˜ë™ ì—°ê²°           |
| **Ch9 ì´í›„**  | ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ UI      | ë¯¸ë“¤ì›¨ì–´, ë³´í˜¸ëœ í˜ì´ì§€         |

ì„œë²„ìš© í´ë¼ì´ì–¸íŠ¸ëŠ” Ch9(ì¸ì¦)ì—ì„œ ë³¸ê²©ì ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤. ì§€ê¸ˆì€ `lib/supabase/client.ts`(ë¸Œë¼ìš°ì €ìš©)ë§Œ ìˆìœ¼ë©´ ì¶©ë¶„í•˜ë‹¤.

**ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸** â€” í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”ê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸:

- [ ] `@supabase/ssr`ì˜ `createBrowserClient`ë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€? (êµ¬ë²„ì „ì¸ `createClient` from `@supabase/supabase-js`ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ë©´ ì¿ í‚¤ ì²˜ë¦¬ê°€ ì•ˆ ëœë‹¤)
- [ ] í™˜ê²½ ë³€ìˆ˜ ì´ë¦„ì´ `.env.local`ê³¼ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ”ê°€?
- [ ] `service_role` í‚¤ê°€ ì•„ë‹Œ `anon` í‚¤ë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?
- [ ] `lib/supabase/client.ts`ì™€ `lib/supabase/server.ts` ë‘ íŒŒì¼ì´ ëª¨ë‘ ìˆëŠ”ê°€?

> **í•¨ê»˜ ì§„í–‰**: í•¨ê»˜ `lib/supabase/client.ts` íŒŒì¼ì„ ë§Œë“¤ê³ , ê°œë°œ ì„œë²„ì—ì„œ ì—ëŸ¬ ì—†ì´ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸í•œë‹¤

### 8.3.4 Vercel í™˜ê²½ ë³€ìˆ˜ ë“±ë¡ + ë°°í¬ `ğŸ–±ï¸ ì§ì ‘ ì‹¤í–‰`

`.env.local`ì€ **ë¡œì»¬ ê°œë°œ ì „ìš©**ì´ë‹¤. Vercelì— ë°°í¬í•˜ë©´ `.env.local`ì€ ë¬´ì‹œëœë‹¤. Vercel ëŒ€ì‹œë³´ë“œì— í™˜ê²½ ë³€ìˆ˜ë¥¼ **ë³„ë„ ë“±ë¡**í•´ì•¼ í•œë‹¤.

> **ì™œ ìˆ˜ë™ì¸ê°€?** â€” Vercel ëŒ€ì‹œë³´ë“œëŠ” ë¸Œë¼ìš°ì €ì—ì„œë§Œ ì¡°ì‘ ê°€ëŠ¥í•˜ë‹¤. í™˜ê²½ ë³€ìˆ˜ì—ëŠ” API í‚¤ê°€ í¬í•¨ë˜ë¯€ë¡œ ì‚¬ëŒì´ ì§ì ‘ í™•ì¸í•˜ë©° ë“±ë¡í•´ì•¼ í•œë‹¤.

**â‘  Vercel ëŒ€ì‹œë³´ë“œ ì ‘ì†**

https://vercel.com â†’ ë¡œê·¸ì¸ â†’ í”„ë¡œì íŠ¸ ì„ íƒ

**â‘¡ í™˜ê²½ ë³€ìˆ˜ ë“±ë¡**

ê²½ë¡œ: **Settings** â†’ **Environment Variables**

| Key                             | Value                              |                Environment                 |
| ------------------------------- | ---------------------------------- | :----------------------------------------: |
| `NEXT_PUBLIC_SUPABASE_URL`      | `https://[í”„ë¡œì íŠ¸ID].supabase.co` | Production, Preview, Development ëª¨ë‘ ì²´í¬ |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | `eyJhbGciOi...` (anon key ì „ì²´)    | Production, Preview, Development ëª¨ë‘ ì²´í¬ |

ê° ë³€ìˆ˜ ì…ë ¥ í›„ **Add** ë²„íŠ¼ì„ í´ë¦­í•œë‹¤.

**â‘¢ ì¬ë°°í¬ (í•„ìˆ˜)**

í™˜ê²½ ë³€ìˆ˜ë¥¼ ë“±ë¡í•œ í›„ **ë°˜ë“œì‹œ ì¬ë°°í¬**í•´ì•¼ ì ìš©ëœë‹¤:

- ë°©ë²• 1: **Deployments** íƒ­ â†’ ê°€ì¥ ìµœê·¼ ë°°í¬ì˜ `â‹®` ë©”ë‰´ â†’ **Redeploy** í´ë¦­
- ë°©ë²• 2: ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê³  `git push` â†’ ìë™ ì¬ë°°í¬

**â‘£ ë°°í¬ í™•ì¸**

ë°°í¬ ì™„ë£Œ í›„ Vercelì´ ì œê³µí•˜ëŠ” URL(`https://í”„ë¡œì íŠ¸ëª….vercel.app`)ì— ì ‘ì†í•˜ì—¬ ì •ìƒ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤.

**Vercel ë°°í¬ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…**:

| ì¦ìƒ                               | ì›ì¸                      | í•´ê²°                                                  |
| ---------------------------------- | ------------------------- | ----------------------------------------------------- |
| "ë¡œì»¬ì—ì„œ ë˜ëŠ”ë° ë°°í¬í•˜ë©´ ì•ˆ ë¼ìš”" | Vercelì— í™˜ê²½ ë³€ìˆ˜ ë¯¸ë“±ë¡ | Settings â†’ Environment Variables í™•ì¸                 |
| í™˜ê²½ ë³€ìˆ˜ ë“±ë¡í–ˆëŠ”ë° ì•ˆ ë¨         | ì¬ë°°í¬ ì•ˆ í•¨              | Redeploy í•„ìˆ˜                                         |
| `NEXT_PUBLIC_` ë³€ìˆ˜ê°€ `undefined`  | Key ì´ë¦„ ì˜¤íƒ€             | `.env.local`ê³¼ Vercel ëŒ€ì‹œë³´ë“œì˜ Key ì´ë¦„ ì •í™•íˆ ë¹„êµ |
| ë¹Œë“œ ì‹¤íŒ¨                          | ì½”ë“œ ì—ëŸ¬ or íŒ¨í‚¤ì§€ ë¬¸ì œ  | Vercel â†’ Deployments â†’ ë¹Œë“œ ë¡œê·¸ í™•ì¸                 |

> **íŒ**: "ë¡œì»¬ì—ì„œ ë˜ëŠ”ë° ë°°í¬í•˜ë©´ ì•ˆ ë¼ìš”"ì˜ **90%ëŠ” Vercelì— í™˜ê²½ ë³€ìˆ˜ë¥¼ ì•ˆ ë„£ì—ˆê¸° ë•Œë¬¸**ì´ë‹¤. ì´ ë‹¨ê³„ë¥¼ ë°˜ë“œì‹œ í™•ì¸í•˜ì.

### 8.3.5 ì—°ê²° í…ŒìŠ¤íŠ¸ `ğŸ¤– ë°”ì´ë¸Œì½”ë”©`

> **ë¼ì´ë¸Œ ì½”ë”©**: Supabase í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ê³  Next.jsì™€ ì—°ê²°í•œ ë’¤, ì—°ê²° í…ŒìŠ¤íŠ¸ê¹Œì§€ ì „ ê³¼ì •ì„ ì§„í–‰í•œë‹¤.

ëª¨ë“  ì„¤ì •ì´ ëë‚¬ìœ¼ë©´ ì‹¤ì œë¡œ ì—°ê²°ì´ ë˜ëŠ”ì§€ í™•ì¸í•œë‹¤. ì„ì‹œë¡œ í˜ì´ì§€ì— í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤:

```tsx
// app/test/page.tsx â€” ì—°ê²° í™•ì¸ìš© (ë‚˜ì¤‘ì— ì‚­ì œ)
"use client";

import { createClient } from "@/lib/supabase/client";
import { useEffect, useState } from "react";

export default function TestPage() {
  const [status, setStatus] = useState("í™•ì¸ ì¤‘...");

  useEffect(() => {
    const supabase = createClient();
    supabase
      .from("_connection_test")
      .select("*")
      .limit(0)
      .then(({ error }) => {
        if (error?.message?.includes("Failed to fetch")) {
          setStatus("ì—°ê²° ì‹¤íŒ¨ â€” í™˜ê²½ ë³€ìˆ˜ë¥¼ í™•ì¸í•˜ì„¸ìš”");
        } else {
          setStatus("Supabase ì—°ê²° ì„±ê³µ!");
        }
      });
  }, []);

  return (
    <div className="p-8">
      <h1 className="text-2xl font-bold">Supabase ì—°ê²° í…ŒìŠ¤íŠ¸</h1>
      <p className="mt-4 text-lg">{status}</p>
    </div>
  );
}
```

`http://localhost:3000/test`ì— ì ‘ì†í•´ì„œ "Supabase ì—°ê²° ì„±ê³µ!"ì´ ë³´ì´ë©´ ì„¤ì •ì´ ì˜¬ë°”ë¥´ë‹¤.

> ì—°ê²° í™•ì¸ì´ ëë‚˜ë©´ `app/test/` í´ë”ëŠ” ì‚­ì œí•´ë„ ëœë‹¤. ë°°í¬ ì „ì— ì •ë¦¬í•˜ëŠ” ìŠµê´€ì„ ë“¤ì¸ë‹¤.

---

## 8.4 ë°ì´í„° ëª¨ë¸ë§

Supabase ì—°ê²°ì´ ì™„ë£Œë˜ì—ˆë‹¤. ì´ì œ **ë°ì´í„°ë¥¼ ì €ì¥í•  ê·¸ë¦‡(í…Œì´ë¸”)**ì„ ë§Œë“¤ ì°¨ë¡€ì´ë‹¤.

> **ì›ë¦¬ â€” ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ ê¸°ì´ˆ**
>
> SupabaseëŠ” **PostgreSQL**(ê´€ê³„í˜• DB)ì„ ì‚¬ìš©í•œë‹¤. ë°ì´í„°ë¥¼ **í‘œ(í…Œì´ë¸”)** í˜•íƒœë¡œ ì €ì¥í•˜ë©°, ì—‘ì…€ ì‹œíŠ¸ì™€ ë¹„ìŠ·í•˜ë‹¤.
>
> | ìš©ì–´              | ë¹„ìœ        | ì„¤ëª…                           |
> | ----------------- | ---------- | ------------------------------ |
> | **í…Œì´ë¸”(Table)** | ì—‘ì…€ ì‹œíŠ¸  | ê°™ì€ ì¢…ë¥˜ì˜ ë°ì´í„°ë¥¼ ëª¨ì€ í‘œ   |
> | **í–‰(Row)**       | ì—‘ì…€ í•œ ì¤„ | ë°ì´í„° í•˜ë‚˜ (ê²Œì‹œê¸€ 1ê°œ)       |
> | **ì—´(Column)**    | ì¹¸ ì œëª©    | ë°ì´í„°ì˜ ì†ì„± (ì œëª©, ë‚´ìš©)     |
> | **ê¸°ë³¸ í‚¤(PK)**   | ì£¼ë¯¼ë²ˆí˜¸   | ê° í–‰ì„ ê³ ìœ í•˜ê²Œ êµ¬ë¶„í•˜ëŠ” ê°’   |
> | **ì™¸ë˜ í‚¤(FK)**   | ì†Œì† ì½”ë“œ  | ë‹¤ë¥¸ í…Œì´ë¸”ì˜ í–‰ì„ ì°¸ì¡°í•˜ëŠ” ê°’ |

### 8.4.1 SQL ìƒì„± â€” Copilotì—ê²Œ ìš”ì²­ `ğŸ¤– ë°”ì´ë¸Œì½”ë”©`

Ch7ì—ì„œ ARCHITECTURE.mdì— ì„¤ê³„í•œ ë°ì´í„° ëª¨ë¸ì„ **ì‹¤ì œ SQL í…Œì´ë¸”**ë¡œ ë§Œë“ ë‹¤. ê²Œì‹œíŒì— í•„ìš”í•œ ìµœì†Œ í…Œì´ë¸”ì€ `profiles`(ì‚¬ìš©ì)ì™€ `posts`(ê²Œì‹œê¸€) 2ê°œì´ë‹¤.

> **ì™œ `users`ê°€ ì•„ë‹Œ `profiles`ì¸ê°€?** â€” Supabase AuthëŠ” ë‚´ë¶€ì ìœ¼ë¡œ `auth.users`ë¥¼ ê´€ë¦¬í•œë‹¤. ì¶”ê°€ ì •ë³´(ë‹‰ë„¤ì„ ë“±)ëŠ” **ë³„ë„ `profiles` í…Œì´ë¸”**ì„ ë§Œë“¤ì–´ `auth.users`ì™€ ì—°ê²°í•œë‹¤(ê³µì‹ íŒ¨í„´).

Copilotì—ê²Œ SQLì„ ìš”ì²­í•œë‹¤. **êµ¬ì²´ì ì¸ í”„ë¡¬í”„íŠ¸**ê°€ í•µì‹¬ì´ë‹¤:

> **âŒ ë‚˜ìœ í”„ë¡¬í”„íŠ¸** â€” "Supabaseì—ì„œ ê²Œì‹œíŒ í…Œì´ë¸” ë§Œë“¤ì–´ì¤˜" â†’ AIê°€ ì„ì˜ë¡œ ì—´ ì´ë¦„/íƒ€ì…ì„ ì •í•˜ê³ , `auth.users` ì—°ê²° ì—†ì´ ìì²´ `users` í…Œì´ë¸”ì„ ë§Œë“¤ ìœ„í—˜.

> **ğŸ¤– Copilot í”„ë¡¬í”„íŠ¸**
> "Supabaseì—ì„œ ê²Œì‹œíŒì„ ìœ„í•œ SQL í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì¤˜.
> profiles í…Œì´ë¸”(id, username, avatar_url)ê³¼ posts í…Œì´ë¸”(id, title, content, user_id, created_at)ì´ í•„ìš”í•´.
> profiles.idëŠ” auth.users.idë¥¼ ì°¸ì¡°í•˜ê³ , posts.user_idëŠ” profiles.idë¥¼ ì°¸ì¡°í•´.
> RLSëŠ” ì•„ì§ ì„¤ì •í•˜ì§€ ë§ˆ."

Copilotì´ ìƒì„±í•œ SQLì„ **ì½ê³  í™•ì¸**í•œë‹¤:

```sql
-- profiles í…Œì´ë¸”
create table profiles (
  id uuid references auth.users(id) on delete cascade,
  username text,
  avatar_url text,
  created_at timestamptz default now(),
  primary key (id)
);

-- posts í…Œì´ë¸”
create table posts (
  id bigint generated always as identity primary key,
  title text not null,
  content text not null,
  user_id uuid references profiles(id) on delete cascade not null,
  created_at timestamptz default now()
);
```

**ì½”ë“œ ì½ê¸° ê°€ì´ë“œ** â€” SQLì„ ì²˜ìŒ ë³´ë”ë¼ë„ ì½ì„ ìˆ˜ ìˆë„ë¡ í•œ ì¤„ì”© í•´ì„í•œë‹¤:

**í‘œ 8.8** profiles í…Œì´ë¸” SQL í•´ì„

| SQL                                    | ì˜ë¯¸                                           |
| -------------------------------------- | ---------------------------------------------- |
| `create table profiles (...)`          | `profiles`ë¼ëŠ” ì´ë¦„ì˜ í…Œì´ë¸”ì„ ìƒì„±í•œë‹¤        |
| `id uuid`                              | `id` ì—´ì˜ íƒ€ì…ì€ UUID (ê³ ìœ  ì‹ë³„ì)            |
| `references auth.users(id)`            | Supabase Authì˜ `users` í…Œì´ë¸” `id`ë¥¼ ì°¸ì¡°í•œë‹¤ |
| `on delete cascade`                    | ì‚¬ìš©ìê°€ ì‚­ì œë˜ë©´ í”„ë¡œí•„ë„ í•¨ê»˜ ì‚­ì œëœë‹¤       |
| `username text`                        | ë¬¸ìì—´ íƒ€ì…ì˜ `username` ì—´                    |
| `created_at timestamptz default now()` | ìƒì„± ì‹œê°, ê¸°ë³¸ê°’ì€ í˜„ì¬ ì‹œê°„                  |
| `primary key (id)`                     | `id`ë¥¼ ê¸°ë³¸ í‚¤ë¡œ ì„¤ì •                          |

**í‘œ 8.9** posts í…Œì´ë¸” SQL í•´ì„

| SQL                                      | ì˜ë¯¸                                     |
| ---------------------------------------- | ---------------------------------------- |
| `id bigint generated always as identity` | ìë™ ì¦ê°€í•˜ëŠ” ìˆ«ì ID                    |
| `title text not null`                    | ì œëª©, ë¹ˆ ê°’ ë¶ˆí—ˆ                         |
| `content text not null`                  | ë‚´ìš©, ë¹ˆ ê°’ ë¶ˆí—ˆ                         |
| `user_id uuid references profiles(id)`   | ì‘ì„±ì, `profiles` í…Œì´ë¸”ì˜ `id`ë¥¼ ì°¸ì¡°  |
| `on delete cascade not null`             | ì‘ì„±ì ì‚­ì œ ì‹œ ê²Œì‹œê¸€ë„ ì‚­ì œ, ë¹ˆ ê°’ ë¶ˆí—ˆ |
| `created_at timestamptz default now()`   | ìƒì„± ì‹œê°, ê¸°ë³¸ê°’ì€ í˜„ì¬ ì‹œê°„            |

> **ì›ë¦¬ â€” 1:N (ì¼ëŒ€ë‹¤) ê´€ê³„**
>
> `profiles (1) â”€â”€â”€â”€â”€â”€< posts (N)` â€” "í•œ ì‚¬ìš©ìê°€ ì—¬ëŸ¬ ê²Œì‹œê¸€ì„ ì“¸ ìˆ˜ ìˆì§€ë§Œ, í•˜ë‚˜ì˜ ê²Œì‹œê¸€ì€ í•œ ì‚¬ìš©ìì—ê²Œë§Œ ì†í•œë‹¤."
> `posts.user_id`(ì™¸ë˜ í‚¤)ê°€ `profiles.id`ë¥¼ ì°¸ì¡°í•˜ë¯€ë¡œ, ê²Œì‹œê¸€ ì¡°íšŒ ì‹œ ì‘ì„±ì ì •ë³´ë¥¼ í•¨ê»˜ ê°€ì ¸ì˜¬ ìˆ˜ ìˆê³ , ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ì IDë¡œ ê²Œì‹œê¸€ì„ ë§Œë“¤ ìˆ˜ ì—†ë‹¤(ì°¸ì¡° ë¬´ê²°ì„±).

### 8.4.2 SQL ì‹¤í–‰ `ğŸ–±ï¸ ì§ì ‘ ì‹¤í–‰`

Copilotì´ ìƒì„±í•œ SQLì„ Supabase ëŒ€ì‹œë³´ë“œì˜ **SQL Editor**ì— ë¶™ì—¬ë„£ê³  ì‹¤í–‰í•œë‹¤.

> **ì™œ ìˆ˜ë™ì¸ê°€?** â€” SQL EditorëŠ” ë¸Œë¼ìš°ì € ëŒ€ì‹œë³´ë“œì´ë¯€ë¡œ Copilotì´ ì§ì ‘ ì‹¤í–‰í•  ìˆ˜ ì—†ë‹¤. Copilotì´ ë§Œë“  SQLì„ **ë³µì‚¬ â†’ SQL Editorì— ë¶™ì—¬ë„£ê¸° â†’ Run ë²„íŠ¼ í´ë¦­**ìœ¼ë¡œ ì§„í–‰í•œë‹¤.

> **í•¨ê»˜ ì§„í–‰**: SQL Editorë¥¼ ì—´ê³ , SQLì„ ë¶™ì—¬ë„£ê³ , "Run" ë²„íŠ¼ì„ í´ë¦­í•œë‹¤

ì‹¤í–‰ í›„ **Table Editor**ë¡œ ì´ë™í•˜ë©´ `profiles`ì™€ `posts` í…Œì´ë¸”ì´ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

> **í”í•œ ì‹¤ìˆ˜**: SQLì„ ë‘ ë²ˆ ì‹¤í–‰í•˜ë©´ "relation already exists" ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤. ì´ë¯¸ í…Œì´ë¸”ì´ ìˆë‹¤ë©´ Table Editorì—ì„œ ì‚­ì œ í›„ ë‹¤ì‹œ ì‹¤í–‰í•˜ê±°ë‚˜, SQL ì•ì— `drop table if exists posts; drop table if exists profiles;`ë¥¼ ì¶”ê°€í•œë‹¤ (ìˆœì„œ ì£¼ì˜: postsë¥¼ ë¨¼ì € ì‚­ì œí•´ì•¼ ì™¸ë˜ í‚¤ ì°¸ì¡° ì—ëŸ¬ê°€ ì•ˆ ë‚œë‹¤).

**í‘œ 8.10** í”í•œ AI ì‹¤ìˆ˜ â€” Supabase í´ë¼ì´ì–¸íŠ¸ ì„¤ì • + SQL

| ì‹¤ìˆ˜ íŒ¨í„´                                             | ì¦ìƒ                           | í•´ê²°                                         |
| ----------------------------------------------------- | ------------------------------ | -------------------------------------------- |
| `createClient` from `@supabase/supabase-js` ì§ì ‘ ì‚¬ìš© | ì¿ í‚¤ ê¸°ë°˜ ì„¸ì…˜ì´ ì‘ë™í•˜ì§€ ì•ŠìŒ | `@supabase/ssr`ì˜ `createBrowserClient` ì‚¬ìš© |
| í™˜ê²½ ë³€ìˆ˜ì— `NEXT_PUBLIC_` ì ‘ë‘ì‚¬ ëˆ„ë½                | ë¸Œë¼ìš°ì €ì—ì„œ `undefined`       | `.env.local` í‚¤ ì´ë¦„ì— ì ‘ë‘ì‚¬ ì¶”ê°€           |
| `.env` íŒŒì¼ ì‚¬ìš© (`.env.local` ëŒ€ì‹ )                  | Gitì— í‚¤ê°€ ë…¸ì¶œë¨              | `.env.local`ë¡œ ë³€ê²½, Git ì´ë ¥ì—ì„œ í‚¤ ì œê±°    |
| `service_role` í‚¤ë¥¼ ë¸Œë¼ìš°ì €ì—ì„œ ì‚¬ìš©                 | ë³´ì•ˆ ì·¨ì•½ì  (RLS ë¬´ì‹œ)         | `anon` í‚¤ë§Œ ë¸Œë¼ìš°ì €ì—ì„œ ì‚¬ìš©                |
| `auth.users` ëŒ€ì‹  ìì²´ `users` í…Œì´ë¸” ìƒì„±            | Supabase ì¸ì¦ê³¼ ì—°ë™ ë¶ˆê°€      | `profiles` â†’ `auth.users(id)` ì°¸ì¡° íŒ¨í„´ ì‚¬ìš© |
| `uuid` ëŒ€ì‹  `int` íƒ€ì… ì‚¬ìš©                           | Auth ì‚¬ìš©ì IDì™€ íƒ€ì… ë¶ˆì¼ì¹˜   | `profiles.id`ëŠ” ë°˜ë“œì‹œ `uuid`                |

---

## 8.5 ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸

Ch7ì—ì„œ ë°°ìš´ ì™¸ë¶€ ì»¨í…ìŠ¤íŠ¸ íŒŒì¼ ê´€ë¦¬ íŒ¨í„´ì„ ì´ë²ˆ ì¥ì—ì„œë„ ì ìš©í•œë‹¤. Supabase ì„¤ì •ì€ **í•œ ë²ˆ í•˜ë©´ ë**ì´ì§€ë§Œ, "ë¬´ì—‡ì„ ì„¤ì •í–ˆê³ , ì–´ë–¤ í‚¤ë¥¼ ì–´ë””ì— ë„£ì—ˆëŠ”ì§€"ë¥¼ ê¸°ë¡í•´ë‘ì§€ ì•Šìœ¼ë©´ ë‹¤ìŒ ì„¸ì…˜ì—ì„œ Copilotì´ í˜¼ë€ì„ ê²ªëŠ”ë‹¤.

**ì„¸ì…˜ ì‹œì‘ í”„ë¡¬í”„íŠ¸** â€” Ch8 ì‘ì—…ì„ ì‹œì‘í•  ë•Œ Copilot Chatì— ì…ë ¥:

```text
#file:context.md #file:todo.md #file:ARCHITECTURE.md

Ch8 Supabase ì—°ê²°ì„ ì‹œì‘í•˜ë ¤ê³  í•´.
context.mdì—ì„œ í˜„ì¬ ìƒíƒœë¥¼ íŒŒì•…í•˜ê³ ,
todo.mdì—ì„œ Supabase ê´€ë ¨ í•  ì¼ì„ í™•ì¸í•´ì¤˜.
Supabase í´ë¼ì´ì–¸íŠ¸ ì„¤ì •ì€ copilot-instructions.md ê·œì¹™ì„ ë”°ë¼ì¤˜.
```

**ì´ ì¥ì—ì„œ context.mdì— ì¶”ê°€í•  ë‚´ìš©**:

```markdown
## ê¸°ìˆ  ê²°ì • ì‚¬í•­ (Ch8 ì¶”ê°€)

- ë°±ì—”ë“œ: Supabase (PostgreSQL + Auth + Storage)
- Supabase í”„ë¡œì íŠ¸ ë¦¬ì „: Northeast Asia (ap-northeast-1)
- í´ë¼ì´ì–¸íŠ¸: @supabase/ssrì˜ createBrowserClient ì‚¬ìš©
- í™˜ê²½ ë³€ìˆ˜: .env.localì— NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY ì„¤ì • ì™„ë£Œ

## í•´ê²°ëœ ì´ìŠˆ (Ch8)

- anon key vs service_role key í˜¼ë™ â†’ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ë°˜ë“œì‹œ anon keyë§Œ ì‚¬ìš©
- .env.local ë³€ê²½ í›„ ë°˜ì˜ ì•ˆ ë¨ â†’ ê°œë°œ ì„œë²„ ì¬ì‹œì‘(npm run dev) í•„ìš”

## ì•Œê²Œ ëœ ì  (Ch8)

- Supabase API í‚¤ ìœ„ì¹˜: Project Settings â†’ Data API (2026ë…„ ê¸°ì¤€)
- profiles í…Œì´ë¸”ì€ auth.users(id)ë¥¼ ì°¸ì¡°í•˜ëŠ” uuid íƒ€ì…ì´ì–´ì•¼ í•œë‹¤
```

**ì„¸ì…˜ ì¢…ë£Œ í”„ë¡¬í”„íŠ¸** â€” ì‘ì—…ì„ ë§ˆì¹  ë•Œ:

```text
Ch8 Supabase ì„¤ì •ì„ ë§ˆë¬´ë¦¬í•˜ë ¤ê³  í•´.
context.mdë¥¼ ì—…ë°ì´íŠ¸í•´ì¤˜:
- ê¸°ìˆ  ê²°ì • ì‚¬í•­: Supabase í”„ë¡œì íŠ¸ ì„¤ì • ë‚´ìš©
- í•´ê²°ëœ ì´ìŠˆ: ì„¤ì • ì¤‘ ê²ªì€ ë¬¸ì œì™€ í•´ê²°ë²•
- ì•Œê²Œ ëœ ì : API í‚¤ ìœ„ì¹˜, í™˜ê²½ ë³€ìˆ˜ ì£¼ì˜ì‚¬í•­ ë“±
todo.mdì—ì„œ "Supabase í”„ë¡œì íŠ¸ ìƒì„±", "ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì‘ì„±" í•­ëª©ì„ ì²´í¬í•˜ê³  ì§„í–‰ë¥ ì„ ê°±ì‹ í•´ì¤˜.
```

> **ì£¼ì˜**: `.env.local`ì˜ ì‹¤ì œ í‚¤ ê°’ì€ context.mdì— ì ˆëŒ€ ì ì§€ ì•ŠëŠ”ë‹¤. "ì„¤ì • ì™„ë£Œ"ë§Œ ê¸°ë¡í•œë‹¤.

---

## í•µì‹¬ ì •ë¦¬ + BíšŒì°¨ ê³¼ì œ ìŠ¤í™

### ì´ë²ˆ ì‹œê°„ í•µì‹¬ 3ê°€ì§€

1. **BaaS**ëŠ” ë°±ì—”ë“œë¥¼ ì§ì ‘ ë§Œë“¤ì§€ ì•Šê³  ì„œë¹„ìŠ¤ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ë‹¤ â€” SupabaseëŠ” PostgreSQL ê¸°ë°˜ ì˜¤í”ˆì†ŒìŠ¤ BaaSì´ë‹¤
2. **í™˜ê²½ ë³€ìˆ˜**ëŠ” `.env.local`ì— ì €ì¥í•˜ê³ , `NEXT_PUBLIC_` ì ‘ë‘ì‚¬ë¥¼ ë¶™ì´ê³ , Vercelì—ë„ ë³„ë„ ë“±ë¡í•œë‹¤
3. **ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤**ëŠ” í…Œì´ë¸”(í‘œ) í˜•íƒœë¡œ ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤ â€” `profiles`ì™€ `posts`ê°€ 1:N ê´€ê³„ë¡œ ì—°ê²°ëœë‹¤

### BíšŒì°¨ ê³¼ì œ ìŠ¤í™

**Supabase ì—°ë™ + ë°ì´í„° ì½ê¸° í˜ì´ì§€ ë°°í¬**:

1. Supabase í”„ë¡œì íŠ¸ ìƒì„± + API í‚¤ í™•ì¸
2. `.env.local` í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
3. `lib/supabase/client.ts` + `lib/supabase/server.ts` í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
4. SQL Editorì—ì„œ `profiles` + `posts` í…Œì´ë¸” ìƒì„±
5. ì—°ê²° í…ŒìŠ¤íŠ¸ ì„±ê³µ í™•ì¸
6. Vercel í™˜ê²½ ë³€ìˆ˜ ë“±ë¡ + ë°°í¬

**ìŠ¤íƒ€í„° ì½”ë“œ**: `practice/chapter8/starter/` â€” Supabase íŒ¨í‚¤ì§€ê°€ ì„¤ì¹˜ëœ Next.js í”„ë¡œì íŠ¸ì™€ ë¹„ì–´ ìˆëŠ” `lib/supabase/` í´ë”ê°€ ì¤€ë¹„ë˜ì–´ ìˆë‹¤.

---

## Exit ticket

ë‹¤ìŒ ì½”ë“œì—ì„œ ì˜ëª»ëœ ë¶€ë¶„ì„ ì°¾ì•„ë¼:

```typescript
// lib/supabase.ts
import { createClient } from "@supabase/supabase-js";

export function initSupabase() {
  return createClient(
    "https://abc123.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  );
}
```

ì •ë‹µ: (1) `@supabase/supabase-js`ì˜ `createClient` ëŒ€ì‹  `@supabase/ssr`ì˜ `createBrowserClient`ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ (ì¿ í‚¤ ê¸°ë°˜ ì„¸ì…˜ ì§€ì›), (2) URLê³¼ í‚¤ê°€ í•˜ë“œì½”ë”©ë˜ì–´ ìˆë‹¤ â€” `process.env.NEXT_PUBLIC_...`ìœ¼ë¡œ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤, (3) í•¨ìˆ˜ëª…ì„ `createClient`ë¡œ í†µì¼í•˜ë©´ ì½”ë“œ ì¼ê´€ì„±ì´ ë†’ì•„ì§„ë‹¤.

---

## í•™ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸

**ìˆ˜ì—… ì „ ì¤€ë¹„**:

- [ ] Supabase ê³„ì • ê°€ì… (https://supabase.com)
- [ ] `.env.local` ì˜ˆì‹œ íŒŒì¼ í™•ì¸
- [ ] SQL í…Œì´ë¸” ìƒì„± ìŠ¤í¬ë¦½íŠ¸ ì¤€ë¹„ (ë³µì‚¬-ë¶™ì—¬ë„£ê¸°ìš©)

**ìê¸° ì ê²€**:

- [ ] BaaS ê°œë…ê³¼ Supabaseì˜ ì—­í• ì„ ì´í•´í–ˆëŠ”ê°€
- [ ] anon key vs service_role key ì°¨ì´ë¥¼ ì´í•´í–ˆëŠ”ê°€
- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ë°©ë²• (`.env.local` + Vercel)ì„ ì´í•´í–ˆëŠ”ê°€
- [ ] ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì˜ í…Œì´ë¸”/í–‰/ì—´ ê°œë…ì„ ì´í•´í–ˆëŠ”ê°€
- [ ] ì„¸ì…˜ ì¢…ë£Œ ì‹œ context.mdì— Supabase ì„¤ì • ë‚´ìš©ì„ ê¸°ë¡í–ˆëŠ”ê°€
